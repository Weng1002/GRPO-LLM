# GRPO-LLM
GRPO (Generalized Rejection Prediction Objective)ï¼Œå®ƒæ˜¯ä¸€ç¨®é‡å°èªè¨€æ¨¡å‹è¨“ç·´çš„ æŒ‡ä»¤æ‹’ç­”è¨“ç·´ç›®æ¨™å‡½æ•¸ï¼ˆæ‹’çµ•ä¸åˆé©è¼¸å‡ºï¼‰ï¼Œé€éè¨“ç·´ä¸€å€‹ä¸­åœ‹é–‹åŸLLMï¼Œä¾†å›ç­”ä¸€äº›åŸæœ¬æ‹’æ­¥å›ç­”çš„é¡Œç›®ã€‚

## Authorï¼šåœ‹ç«‹é™½æ˜äº¤é€šå¤§å­¸ è³‡è¨Šç®¡ç†èˆ‡è²¡å‹™é‡‘èå­¸ç³»è²¡å‹™é‡‘èæ‰€ç¢©ä¸€ 313707043 ç¿æ™ºå®

![Task](task.jpg)

## ğŸ¯ ä»»å‹™ç›®æ¨™

æœ¬å°ˆæ¡ˆç›®çš„æ˜¯é€é **GRPO** æŠ€è¡“ï¼Œåœ¨æœ¬åœ°ç«¯å¾®èª¿é–‹æºä¸­æ–‡èªè¨€æ¨¡å‹ï¼ˆå¦‚ Qwen2.5-3Bï¼‰ï¼Œä½¿æ¨¡å‹å­¸æœƒæ ¹æ“šè¼¸å…¥é¸æ“‡é¡Œå›ç­”æ­£ç¢ºé¸é …ï¼Œæˆ–åœ¨ç„¡æ³•åˆ¤æ–·æ™‚æ‹’çµ•çµ¦å‡ºéŒ¯èª¤ç­”æ¡ˆã€‚

> ğŸ“Œ æ­¤ä»»å‹™ç¦æ­¢ä½¿ç”¨éä¸­åœ‹é‡‹å‡ºçš„æ¨¡å‹æˆ–ä»»ä½•é›²ç«¯æ¨è«–è³‡æºï¼Œä¸¦ä»¥ Local è¨“ç·´èˆ‡æœ¬åœ°æ¨ç†ç‚ºä¸»ã€‚

---

## ğŸ§° ä½¿ç”¨æŠ€è¡“èˆ‡æ¨¡å‹

| å…ƒä»¶        | æè¿° |
|-------------|------|
| ğŸŒ Model     | `Qwen/Qwen2.5-3B-Instruct`ï¼ˆä¸­åœ‹é‡‹å‡ºï¼‰ |
| ğŸ§© Fine-tune | ä½¿ç”¨ `LoRA` å¾®èª¿æŠ€è¡“ï¼Œçµåˆ `GRPOTrainer` |
| ğŸ§  Reward    | è‡ªå®šç¾© reward functionï¼Œæ ¹æ“š `<reasoning>` é•·åº¦èˆ‡ `<answer>` æ˜¯å¦æ­£ç¢ºçµ¦åˆ† |
| ğŸ“„ Dataset   | é¡Œç›®ã€é¸é …èˆ‡æ­£ç¢ºç­”æ¡ˆçµ„æˆçš„ `.csv` æ ¼å¼ï¼ˆtrain/testï¼‰ |

---

## ğŸ§  æ–¹æ³•æ¦‚è¿°

- **æ¨¡å‹ä¾†æº**ï¼šQwen/Qwen2.5-3B-Instructï¼Œä½¿ç”¨ Hugging Face æ¨¡å‹å€‰åº«ä¸‹è¼‰ã€‚
- **è¨“ç·´è³‡æ–™æ ¼å¼**ï¼š
  - æ¬„ä½ï¼šé¡Œç›®ã€é¸é …A~Dã€æ¨ç†æ­£ç¢ºç­”æ¡ˆã€æ­£ç¢ºç­”æ¡ˆ
  - è¼¸å…¥ prompt ç¯„ä¾‹ï¼š
    ```
    è«‹é–±è®€ä»¥ä¸‹é¸æ“‡é¡Œï¼Œä¸¦è¼¸å‡ºè§£é¡Œæ­¥é©Ÿèˆ‡æ­£ç¢ºç­”æ¡ˆï¼ˆä½¿ç”¨æŒ‡å®šæ ¼å¼ï¼‰ï¼š
    å•é¡Œå…§å®¹...
    A. é¸é …Aå…§å®¹
    B. é¸é …Bå…§å®¹
    C. é¸é …Cå…§å®¹
    D. é¸é …Då…§å®¹
    è«‹ä¾ç…§ä»¥ä¸‹æ ¼å¼è¼¸å‡ºï¼š
    <reasoning>...</reasoning>
    <answer>...</answer>
    ```
  - è¼¸å‡º output ç¯„ä¾‹ï¼ˆtargetï¼‰ï¼š
    ```
    <reasoning>
    è§£é¡Œæ­¥é©Ÿèªªæ˜...
    </reasoning>
    <answer>
    B
    </answer>
    ```

---

## ğŸ›  ç’°å¢ƒå®‰è£

æœ¬å°ˆæ¡ˆéœ€è¦ä»¥ä¸‹ Python å¥—ä»¶èˆ‡ç¡¬é«”è³‡æºï¼š

```bash
pip install unsloth vllm bitsandbytes peft transformers datasets trl accelerate einops
pip install --upgrade transformers accelerate bitsandbytes
